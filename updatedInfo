Most of code is working fine but an issue with replace all still exists.. working on it for eternity but to no avail
